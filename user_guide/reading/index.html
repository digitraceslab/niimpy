

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reading &mdash; Niimpy dev documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=3c2ae12a"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Basic transformations" href="../basic-transformations/" />
    <link rel="prev" title="Quick start" href="../../quick-start/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../" class="icon icon-home">
            Niimpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/installation/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/architecture/">Architecture and workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/schema/">Data schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/contribution_guide/">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/How-to-cite/">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/see-also/">See also</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quick-start/">Quick start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#DataFrame-format-(in-memory)">DataFrame format (in-memory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#CSV-files">CSV files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sqlite3-databases">sqlite3 databases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Note-of-incorrect-encoding">Note of incorrect encoding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Google-TakeOut">Google TakeOut</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Location">Location</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Activity">Activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Email-and-Chat">Email and Chat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Youtube-Activity">Youtube Activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#General-Notes-on-Google-Takeout">General Notes on Google Takeout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#MHealth">MHealth</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Other-formats">Other formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic-transformations/">Basic transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocessing/">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Exploration/">Exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Analysis/">Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Demos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../demo/student_life_example/">Demo Notebook on Reading and Exploring the Studentlife Dataset</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aware/">Aware</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules/">niimpy API docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Niimpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Reading</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/user_guide/reading.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Reading">
<h1>Reading<a class="headerlink" href="#Reading" title="Link to this heading"></a></h1>
<p>In principle, Niimpy can deal with any files of any format - you only need to convert them to a DataFrame. Still, it is very useful to have some common formats, so we present two standard formats with default readers:</p>
<ul class="simple">
<li><p><strong>CSV files</strong> are very standard and normal to create and understand, but in order to deal with them everything must be loaded into memory.</p></li>
<li><p><strong>Google TakeOut</strong> provides a large selection of data in different formats. We provide readers most commonly used data types.</p></li>
<li><p><strong>MHealth</strong> is a common format for health data.</p></li>
<li><p><strong>sqlite3 databases</strong>, which requires sqlite3 to read, provides more power for filtering and automatic processing without reading everything into memory.</p></li>
</ul>
<section id="DataFrame-format-(in-memory)">
<h2>DataFrame format (in-memory)<a class="headerlink" href="#DataFrame-format-(in-memory)" title="Link to this heading"></a></h2>
<p>In-memory, data is stored in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">pandas DataFrame</a>. This is basically a normal dataframe. There are some standardized columns (see the <a class="reference external" href="/about/schema.html">schema</a>) and the index is a DatetimeIndex.</p>
</section>
<section id="CSV-files">
<h2>CSV files<a class="headerlink" href="#CSV-files" title="Link to this heading"></a></h2>
<p>CSV files should have a header that lists the column names and generally be readable by <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code>.</p>
<p>Reading these can be done with <code class="docutils literal notranslate"><span class="pre">niimpy.read_csv</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">niimpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">niimpy.config</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">config</span>

<span class="c1"># Read the battery data</span>
<span class="n">df</span><span class="o">=</span> <span class="n">niimpy</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">MULTIUSER_AWARE_BATTERY_PATH</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;Europe/Helsinki&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="sqlite3-databases">
<h2>sqlite3 databases<a class="headerlink" href="#sqlite3-databases" title="Link to this heading"></a></h2>
<p>For the purposes of niimpy, sqlite3 databases can generally be seen as supercharged CSV files.</p>
<p>A single database file could contain multiple datasets within it, thus when reading them a <strong>table name</strong> must be specified.</p>
<p>One reads the entire database into memory using <code class="docutils literal notranslate"><span class="pre">sqlite.read_sqlite</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the sqlite3 data</span>
<span class="n">df</span><span class="o">=</span> <span class="n">niimpy</span><span class="o">.</span><span class="n">read_sqlite</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">SQLITE_SINGLEUSER_PATH</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;AwareScreen&quot;</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;Europe/Helsinki&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can list the tables within a database using <code class="docutils literal notranslate"><span class="pre">niimpy.reading.read.read_sqlite_tables</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">read_sqlite_tables</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">SQLITE_SINGLEUSER_PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;AwareScreen&#39;}
</pre></div></div>
</div>
<p>sqlite3 files are highly recommended as a data storage format, since many common exploration options can be done within the database itself without reading the whole data into memory or writing an iterator. However, the interface is more difficult to use. Niimpy (before 2021-07) used this as its primary interface, but since then this interface has been de-emphasized. You can read more in <a class="reference external" href="/database.html">the database section</a>, but this is only recommended if you need efficiency when using
massive amounts of data.</p>
<section id="Note-of-incorrect-encoding">
<h3>Note of incorrect encoding<a class="headerlink" href="#Note-of-incorrect-encoding" title="Link to this heading"></a></h3>
<p>Sometimes a sqlite3 database has incorrect metadata for character encoding. This is a common issue with languages that cannot be encoded with <code class="docutils literal notranslate"><span class="pre">utf-8</span></code>, such as Finnish. When this happens, use the function <code class="docutils literal notranslate"><span class="pre">niimpy.utils.set_encoding()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">niimpy</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">niimpy</span><span class="o">.</span><span class="n">read_sqlite</span><span class="p">(</span>
    <span class="n">config</span><span class="o">.</span><span class="n">SQLITE_SINGLEUSER_PATH</span><span class="p">,</span>
    <span class="n">table</span><span class="o">=</span><span class="s2">&quot;AwareScreen&quot;</span><span class="p">,</span>
    <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;Europe/Helsinki&#39;</span>
<span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">niimpy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">set_encoding</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="n">to_encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span>
    <span class="n">from_encoding</span> <span class="o">=</span> <span class="s1">&#39;iso-8859-1&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="Google-TakeOut">
<h2>Google TakeOut<a class="headerlink" href="#Google-TakeOut" title="Link to this heading"></a></h2>
<p>Google takeout contains a many different types of data and new types are added as Google creates services or changes data storage methods. Readers are currently available for location data, emails, and activity data from the fit app. For other data types, the user needs to manually convert them into a Niimpy compatible Pandas DataFrame.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data downloaded from Google Takeout is compressed as a zip archive to conserve disk space. To</span>
<span class="c1"># demonstrate reading for the zip file, we will first compress our example data into the zip format.</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="n">test_zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span><span class="n">dirs</span><span class="p">,</span><span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">GOOGLE_TAKEOUT_DIR</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">filename_in_zip</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">GOOGLE_TAKEOUT_DIR</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">test_zip</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filename_in_zip</span><span class="p">)</span>

<span class="n">test_zip</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<section id="Location">
<h3>Location<a class="headerlink" href="#Location" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Next we read location data from the zip file.</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">niimpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">niimpy.config</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">config</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">niimpy.preprocessing.location</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nilo</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">location_history</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">nilo</span><span class="o">.</span><span class="n">filter_location</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">latitude_column</span> <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span><span class="p">,</span>
    <span class="n">longitude_column</span> <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
    <span class="n">remove_disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_network</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zeros</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">data</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>accuracy</th>
      <th>source</th>
      <th>device</th>
      <th>placeid</th>
      <th>formfactor</th>
      <th>altitude</th>
      <th>verticalaccuracy</th>
      <th>platformtype</th>
      <th>servertimestamp</th>
      <th>devicetimestamp</th>
      <th>batterycharging</th>
      <th>velocity</th>
      <th>heading</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>inferred_latitude</th>
      <th>inferred_longitude</th>
      <th>activity_type</th>
      <th>activity_inference_confidence</th>
      <th>user</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-08-12 19:29:43.821000+00:00</th>
      <td>25</td>
      <td>WIFI</td>
      <td>-577680260</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.997488</td>
      <td>-78.922194</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f1066868-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2016-08-12 19:30:49.531000+00:00</th>
      <td>21</td>
      <td>WIFI</td>
      <td>-577680260</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.997559</td>
      <td>-78.922504</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>STILL</td>
      <td>62.0</td>
      <td>f1066868-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2016-08-12 19:31:49.531000+00:00</th>
      <td>21</td>
      <td>WIFI</td>
      <td>-577680260</td>
      <td>ChIJS_5Nmuz1jUYRGYf3QiiZco4</td>
      <td>PHONE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.997559</td>
      <td>-78.922504</td>
      <td>60.187135</td>
      <td>24.824478</td>
      <td>STILL</td>
      <td>62.0</td>
      <td>f1066868-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2016-08-12 21:15:55.295000+00:00</th>
      <td>1500</td>
      <td>CELL</td>
      <td>-577680260</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>36.000870</td>
      <td>-78.923343</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ON_FOOT</td>
      <td>54.0</td>
      <td>f1066868-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2016-08-12 21:16:33+00:00</th>
      <td>8</td>
      <td>GPS</td>
      <td>-577680260</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.997250</td>
      <td>-78.923989</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f1066868-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2016-08-12 21:16:48+00:00</th>
      <td>3</td>
      <td>GPS</td>
      <td>-577680260</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.997236</td>
      <td>-78.924124</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f1066868-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2023-11-21 11:29:21.730000+00:00</th>
      <td>13</td>
      <td>WIFI</td>
      <td>1832214273</td>
      <td>ChIJw1WKQev1jUYRCdZmYR-HCiI</td>
      <td>PHONE</td>
      <td>28.0</td>
      <td>2.0</td>
      <td>ANDROID</td>
      <td>2023-11-21T11:29:24.747Z</td>
      <td>2023-11-21T11:29:24.350Z</td>
      <td>False</td>
      <td></td>
      <td></td>
      <td>60.186818</td>
      <td>24.821288</td>
      <td>60.186816</td>
      <td>24.821288</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>f1066868-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Activity">
<h3>Activity<a class="headerlink" href="#Activity" title="Link to this heading"></a></h3>
<p>Activity data is read similarly. The data contains many columns with missing data, so in order to use the step count data, for example, we must set the NaN values to 0.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">activity</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;step_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="s2">&quot;step_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span><span class="p">[[</span><span class="s2">&quot;calories_(kcal)&quot;</span><span class="p">,</span> <span class="s2">&quot;step_count&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>calories_(kcal)</th>
      <th>step_count</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-11-20 00:00:00+02:00</th>
      <td>1752.250027</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2023-11-21 00:00:00+02:00</th>
      <td>1996.456746</td>
      <td>89.900002</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Google Fit Takeout data can contain more detailed information. To access this data, we first list all data types stored in Google Fit data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">fit_list_data</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>filename</th>
      <th>derived</th>
      <th>content</th>
      <th>source</th>
      <th>source type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>raw_com.google.step_count.delta_fi.polar.polar...</td>
      <td>raw</td>
      <td>step_count.delta</td>
      <td>fi.test.test</td>
      <td>step count</td>
    </tr>
    <tr>
      <th>1</th>
      <td>derived_com.google.step_count.delta_com.google...</td>
      <td>derived</td>
      <td>step_count.delta</td>
      <td>com.google.android.fit</td>
      <td>top_level</td>
    </tr>
    <tr>
      <th>2</th>
      <td>derived_com.google.respiratory_rate_com.google...</td>
      <td>derived</td>
      <td>respiratory_rate</td>
      <td>com.google.android.gms</td>
      <td>merge_respiratory_rate</td>
    </tr>
    <tr>
      <th>3</th>
      <td>raw_com.google.sleep.segment_com.urbandroid.sl...</td>
      <td>raw</td>
      <td>sleep.segment</td>
      <td>com.urbandroid.sleep</td>
      <td>saa-generic</td>
    </tr>
    <tr>
      <th>4</th>
      <td>raw_com.google.heart_rate.summary_fi.polar.pol...</td>
      <td>raw</td>
      <td>heart_rate.summary</td>
      <td>fi.test.testtest</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>raw_com.google.calories.expended_fi.polar.pola...</td>
      <td>raw</td>
      <td>calories.expended</td>
      <td>fi.manual.manualtest</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>derived_com.google.sleep.segment_com.google.an...</td>
      <td>derived</td>
      <td>sleep.segment</td>
      <td>com.google.android.gms</td>
      <td>merged</td>
    </tr>
    <tr>
      <th>7</th>
      <td>raw_com.google.nutrition_com.fourtechnologies....</td>
      <td>raw</td>
      <td>nutrition</td>
      <td>com.manual.test</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>raw_com.google.heart_rate.bpm_nl.appyhapps.hea...</td>
      <td>raw</td>
      <td>heart_rate.bpm</td>
      <td>fi.test.test</td>
      <td>Test - heart rate</td>
    </tr>
    <tr>
      <th>9</th>
      <td>raw_com.google.sleep.segment_nl.appyhapps.heal...</td>
      <td>raw</td>
      <td>sleep.segment</td>
      <td>nl.test.healthsync</td>
      <td>HealthSync_sleep_by_Health_Sync_1715724879000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>raw_com.google.heart_minutes_com.google.androi...</td>
      <td>raw</td>
      <td>heart_minutes</td>
      <td>com.google.android.apps.fitness</td>
      <td>user_input</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We have two types of step count data. The original raw data is in “raw_com.google.step_count.delta_fi.polar.polar.json”. You can read this data using <code class="docutils literal notranslate"><span class="pre">fit_read_data</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">fit_read_data</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;raw_com.google.step_count.delta_fi.polar.polar.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>measurement_index</th>
      <th>id</th>
      <th>value</th>
      <th>end_time</th>
      <th>modified_time</th>
      <th>datatype</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-04-30 17:59:58.999</th>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2024-04-30 19:17:00</td>
      <td>2024-05-01 03:15:57.130</td>
      <td>step_count.delta</td>
    </tr>
    <tr>
      <th>2024-04-30 17:59:58.999</th>
      <td>1</td>
      <td>0</td>
      <td>8</td>
      <td>2024-04-30 19:17:30</td>
      <td>2024-04-30 20:02:14.506</td>
      <td>step_count.delta</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Email-and-Chat">
<h3>Email and Chat<a class="headerlink" href="#Email-and-Chat" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">google_takeout.email_activity</span></code> and <code class="docutils literal notranslate"><span class="pre">google_takeout.chat</span></code> function will read and process all emails in the GMail mailbox and all Google chat messages respectively. They return a dataframe containing metadata and statistics of each message. Email addresses, email IDs and names are replaced by numerical indexes.</p>
<p>The email files can be large and processing them could take some time. You can also include sentiment analysis of each email using the <code class="docutils literal notranslate"><span class="pre">sentiment</span></code> parameter. For this, we recommend using a system with a GPU.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">email_activity</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/u/24/rantahj1/unix/src/niimpy/niimpy/reading/google_takeout.py:466: UserWarning: Could not parse message timestamp: 2023-12-15 12:19:43+00:00
  warnings.warn(f&#34;Could not parse message timestamp: {received}&#34;)
/u/24/rantahj1/unix/src/niimpy/niimpy/reading/google_takeout.py:480: UserWarning: Failed to format received time: Sat, 15 DeNot a timec 2023 12:19:43 0000
  warnings.warn(f&#34;Failed to format received time: {received}&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>received</th>
      <th>from</th>
      <th>to</th>
      <th>cc</th>
      <th>bcc</th>
      <th>message_id</th>
      <th>in_reply_to</th>
      <th>character_count</th>
      <th>word_count</th>
      <th>message_type</th>
      <th>user</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-12-15 12:19:43+00:00</th>
      <td>NaT</td>
      <td>0</td>
      <td>[2]</td>
      <td>[]</td>
      <td>[]</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>33</td>
      <td>6</td>
      <td>outgoing</td>
      <td>f10e4d26-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2023-12-15 12:29:43+00:00</th>
      <td>NaT</td>
      <td>0</td>
      <td>[6, 2]</td>
      <td>[]</td>
      <td>[]</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>31</td>
      <td>6</td>
      <td>outgoing</td>
      <td>f10e4d26-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2023-12-15 12:29:43+00:00</th>
      <td>NaT</td>
      <td>0</td>
      <td>[6, 2]</td>
      <td>[]</td>
      <td>[]</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>28</td>
      <td>5</td>
      <td>outgoing</td>
      <td>f10e4d26-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2023-12-15 12:39:43+00:00</th>
      <td>2023-12-15 12:19:43+00:00</td>
      <td>6</td>
      <td>[0]</td>
      <td>[4]</td>
      <td>[4]</td>
      <td>3</td>
      <td>2</td>
      <td>30</td>
      <td>5</td>
      <td>incoming</td>
      <td>f10e4d26-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2023-12-15 12:39:43+00:00</th>
      <td>Sat, 15 DeNot a timec 2023 12:19:43 0000</td>
      <td>6</td>
      <td>[0]</td>
      <td>[4]</td>
      <td>[4]</td>
      <td>3</td>
      <td>2</td>
      <td>51</td>
      <td>7</td>
      <td>incoming</td>
      <td>f10e4d26-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Google chat data is read similarly.</p>
<p>Additionally, you can run sentiment analysis on email and chat messages using the <code class="docutils literal notranslate"><span class="pre">sentiment</span></code> option. To run sentiment analysis, you need to install the optional dependency by running.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>niimpy<span class="o">[</span>sentiment<span class="o">]</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">chat</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">,</span> <span class="n">sentiment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/u/24/rantahj1/unix/src/niimpy/niimpy/reading/google_takeout.py:648: UserWarning: Multiple user emails found. Using the first one.
  warnings.warn(&#34;Multiple user emails found. Using the first one.&#34;)
  0%|          | 0/4 [00:01&lt;?, ?it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>topic_id</th>
      <th>message_id</th>
      <th>chat_group</th>
      <th>creator_name</th>
      <th>creator_email</th>
      <th>creator_user_type</th>
      <th>character_count</th>
      <th>word_count</th>
      <th>user</th>
      <th>message_type</th>
      <th>sentiment</th>
      <th>sentiment_score</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-01-30 13:27:33+00:00</th>
      <td>iDImYGRudHk</td>
      <td>9guW_0AAAAE/iDImYGRudHk/iDImYGRudHk</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Human</td>
      <td>5</td>
      <td>1</td>
      <td>f1144500-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>outgoing</td>
      <td>none</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-01-30 13:29:10+00:00</th>
      <td>cVEoT9zu63M</td>
      <td>9guW_0AAAAE/cVEoT9zu63M/cVEoT9zu63M</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>Human</td>
      <td>5</td>
      <td>1</td>
      <td>f1144500-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>incoming</td>
      <td>none</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2024-01-30 13:29:17+00:00</th>
      <td>qEfkUgUvX80</td>
      <td>9guW_0AAAAE/qEfkUgUvX80/qEfkUgUvX80</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>Human</td>
      <td>11</td>
      <td>3</td>
      <td>f1144500-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>incoming</td>
      <td>positive</td>
      <td>0.535310</td>
    </tr>
    <tr>
      <th>2024-01-30 13:29:17+00:00</th>
      <td>qEfkUgUvX80</td>
      <td>9guW_0AAAAE/qEfkUgUvX80/qEfkUgUvX80</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Human</td>
      <td>22</td>
      <td>5</td>
      <td>f1144500-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>outgoing</td>
      <td>positive</td>
      <td>0.912528</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Youtube-Activity">
<h3>Youtube Activity<a class="headerlink" href="#Youtube-Activity" title="Link to this heading"></a></h3>
<p>Finally, we have a reader for extracting Youtube watch history data. We do not, by default, return video identifiers, but replace them with numerical IDs. The only available information then is the recorded time, which corresponds to video start time.</p>
<p>Importantly, we have no information on how long the user watched a given video, as this is not stored in the TakeOut data. You can deduce whether the user has rewatched a given video, watched multiple videos in a row, or started another video quickly without finishing the previous one.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">youtube_watch_history</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>video_title</th>
      <th>channel_title</th>
      <th>user</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-02-13 08:36:49+02:00</th>
      <td>0</td>
      <td>0</td>
      <td>f1f6ae72-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2024-02-13 08:36:05+02:00</th>
      <td>1</td>
      <td>1</td>
      <td>f1f6ae72-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2024-02-13 08:35:38+02:00</th>
      <td>2</td>
      <td>2</td>
      <td>f1f6ae72-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
    <tr>
      <th>2024-02-13 08:35:03+02:00</th>
      <td>0</td>
      <td>0</td>
      <td>f1f6ae72-2e1d-11ef-abd1-b0dcef010c43</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Since Google takeout may provide the mailbox as a single uncompressed file, it is also possible to provide it’s file path directly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">GOOGLE_TAKEOUT_DIR</span><span class="p">,</span> <span class="s2">&quot;Takeout&quot;</span><span class="p">,</span> <span class="s2">&quot;Mail&quot;</span><span class="p">,</span> <span class="s2">&quot;All mail Including Spam and Trash.mbox&quot;</span><span class="p">)</span>
<span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">google_takeout</span><span class="o">.</span><span class="n">email_activity</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sentiment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/u/24/rantahj1/unix/src/niimpy/niimpy/reading/google_takeout.py:466: UserWarning: Could not parse message timestamp: 2023-12-15 12:19:43+00:00
  warnings.warn(f&#34;Could not parse message timestamp: {received}&#34;)
/u/24/rantahj1/unix/src/niimpy/niimpy/reading/google_takeout.py:480: UserWarning: Failed to format received time: Sat, 15 DeNot a timec 2023 12:19:43 0000
  warnings.warn(f&#34;Failed to format received time: {received}&#34;)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running sentiment analysis on 5 messages.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
  0%|          | 0/5 [00:00&lt;?, ?it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>received</th>
      <th>from</th>
      <th>to</th>
      <th>cc</th>
      <th>bcc</th>
      <th>message_id</th>
      <th>in_reply_to</th>
      <th>character_count</th>
      <th>word_count</th>
      <th>message_type</th>
      <th>user</th>
      <th>sentiment</th>
      <th>sentiment_score</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-12-15 12:19:43+00:00</th>
      <td>NaT</td>
      <td>0</td>
      <td>[1]</td>
      <td>[]</td>
      <td>[]</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>33</td>
      <td>6</td>
      <td>outgoing</td>
      <td>f1f97e90-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>positive</td>
      <td>0.993223</td>
    </tr>
    <tr>
      <th>2023-12-15 12:29:43+00:00</th>
      <td>NaT</td>
      <td>0</td>
      <td>[6, 1]</td>
      <td>[]</td>
      <td>[]</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>31</td>
      <td>6</td>
      <td>outgoing</td>
      <td>f1f97e90-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>negative</td>
      <td>0.980209</td>
    </tr>
    <tr>
      <th>2023-12-15 12:29:43+00:00</th>
      <td>NaT</td>
      <td>0</td>
      <td>[6, 1]</td>
      <td>[]</td>
      <td>[]</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>28</td>
      <td>5</td>
      <td>outgoing</td>
      <td>f1f97e90-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>negative</td>
      <td>0.968588</td>
    </tr>
    <tr>
      <th>2023-12-15 12:39:43+00:00</th>
      <td>2023-12-15 12:19:43+00:00</td>
      <td>6</td>
      <td>[0]</td>
      <td>[4]</td>
      <td>[4]</td>
      <td>3</td>
      <td>2</td>
      <td>30</td>
      <td>5</td>
      <td>incoming</td>
      <td>f1f97e90-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>positive</td>
      <td>0.997529</td>
    </tr>
    <tr>
      <th>2023-12-15 12:39:43+00:00</th>
      <td>Sat, 15 DeNot a timec 2023 12:19:43 0000</td>
      <td>6</td>
      <td>[0]</td>
      <td>[4]</td>
      <td>[4]</td>
      <td>3</td>
      <td>2</td>
      <td>51</td>
      <td>7</td>
      <td>incoming</td>
      <td>f1f97e90-2e1d-11ef-abd1-b0dcef010c43</td>
      <td>neutral</td>
      <td>0.477333</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="General-Notes-on-Google-Takeout">
<h3>General Notes on Google Takeout<a class="headerlink" href="#General-Notes-on-Google-Takeout" title="Link to this heading"></a></h3>
<p>Each subject Downloads their Google TakeOut data as a separate zip file. The Zipfile package, which is included in the Python standard, is convenient for reading the data files contained in the zip file. For example, one could read the location data with the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">zipfile</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">zip_file</span> <span class="o">=</span> <span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;test.zip&quot;</span><span class="p">)</span>
<span class="n">json_data</span>  <span class="o">=</span> <span class="n">zip_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;Takeout/Location History (Timeline)/Records.json&quot;</span><span class="p">)</span>
<span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;locations&quot;</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latitudeE7</th>
      <th>longitudeE7</th>
      <th>accuracy</th>
      <th>source</th>
      <th>deviceTag</th>
      <th>timestamp</th>
      <th>activity</th>
      <th>locationMetadata</th>
      <th>placeId</th>
      <th>formFactor</th>
      <th>...</th>
      <th>deviceDesignation</th>
      <th>altitude</th>
      <th>verticalAccuracy</th>
      <th>platformType</th>
      <th>osLevel</th>
      <th>serverTimestamp</th>
      <th>deviceTimestamp</th>
      <th>batteryCharging</th>
      <th>velocity</th>
      <th>heading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>359974880</td>
      <td>-789221943</td>
      <td>25</td>
      <td>WIFI</td>
      <td>-577680260</td>
      <td>2016-08-12T19:29:43.821Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>359975588</td>
      <td>-789225036</td>
      <td>21</td>
      <td>WIFI</td>
      <td>-577680260</td>
      <td>2016-08-12T19:30:49.531Z</td>
      <td>[{'activity': [{'type': 'STILL', 'confidence':...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>359975588</td>
      <td>-789225036</td>
      <td>21</td>
      <td>WIFI</td>
      <td>-577680260</td>
      <td>2016-08-12T19:31:49.531Z</td>
      <td>[{'activity': [{'type': 'STILL', 'confidence':...</td>
      <td>[{'wifiScan': {'accessPoints': [{'mac': '12410...</td>
      <td>ChIJS_5Nmuz1jUYRGYf3QiiZco4</td>
      <td>PHONE</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>360008703</td>
      <td>-789233433</td>
      <td>1500</td>
      <td>CELL</td>
      <td>-577680260</td>
      <td>2016-08-12T21:15:55.295Z</td>
      <td>[{'activity': [{'type': 'ON_FOOT', 'confidence...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>359972502</td>
      <td>-789239894</td>
      <td>8</td>
      <td>GPS</td>
      <td>-577680260</td>
      <td>2016-08-12T21:16:33Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div>
</div>
<p>Location data is stored in the json format. Other types of data are stored in various formats and with different files structures. The user must find how each type of data they need is stored and how it can be read in Python.</p>
</section>
</section>
<section id="MHealth">
<h2>MHealth<a class="headerlink" href="#MHealth" title="Link to this heading"></a></h2>
<p>We have implemented readers for 3 data types formatted according to the <a class="reference external" href="https://www.openmhealth.org/documentation/#/schema-docs/schema-library">MHealth schema</a>. These are total sleep time, heart rate and geolocation. Other data types may be added as needed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading total sleep time data:</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">MHEALTH_TOTAL_SLEEP_TIME_PATH</span>
<span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">mhealth</span><span class="o">.</span><span class="n">total_sleep_time_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>descriptive_statistic</th>
      <th>descriptive_statistic_denominator</th>
      <th>date</th>
      <th>part_of_day</th>
      <th>total_sleep_time</th>
      <th>start</th>
      <th>end</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-02-06 04:35:00+00:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>0 days 07:45:00</td>
      <td>2016-02-06 04:35:00+00:00</td>
      <td>2016-02-06 14:35:00+00:00</td>
    </tr>
    <tr>
      <th>2016-02-05 15:00:00+00:00</th>
      <td>average</td>
      <td>d</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>0 days 07:15:00</td>
      <td>2016-02-05 15:00:00+00:00</td>
      <td>2016-06-06 15:00:00+00:00</td>
    </tr>
    <tr>
      <th>2013-01-26 07:35:00+00:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>0 days 03:00:00</td>
      <td>2013-01-26 07:35:00+00:00</td>
      <td>2013-02-05 07:35:00+00:00</td>
    </tr>
    <tr>
      <th>2013-02-05 00:00:00+00:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2013-02-05 00:00:00+00:00</td>
      <td>evening</td>
      <td>0 days 03:00:00</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading heart rate data:</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">MHEALTH_HEART_RATE_PATH</span>
<span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">mhealth</span><span class="o">.</span><span class="n">heart_rate_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temporal_relationship_to_sleep</th>
      <th>heart_rate</th>
      <th>effective_time_frame.date_time</th>
      <th>descriptive_statistic</th>
      <th>start</th>
      <th>end</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NaT</th>
      <td>on waking</td>
      <td>70</td>
      <td>2023-11-20T07:25:00-08:00</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>2023-12-20 09:50:00+00:00</th>
      <td>on waking</td>
      <td>65</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2023-12-20 09:50:00+00:00</td>
      <td>2023-12-20 10:00:00+00:00</td>
    </tr>
    <tr>
      <th>2023-12-20 03:50:00+00:00</th>
      <td>during sleep</td>
      <td>35</td>
      <td>NaN</td>
      <td>average</td>
      <td>2023-12-20 03:50:00+00:00</td>
      <td>2023-12-20 04:00:00+00:00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading geolocation data:</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">MHEALTH_GEOLOCATION_PATH</span>
<span class="n">niimpy</span><span class="o">.</span><span class="n">reading</span><span class="o">.</span><span class="n">mhealth</span><span class="o">.</span><span class="n">geolocation_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>positioning_system</th>
      <th>latitude</th>
      <th>latitude.unit</th>
      <th>longitude</th>
      <th>longitude.unit</th>
      <th>effective_time_frame.time_interval.start_date_time</th>
      <th>effective_time_frame.time_interval.end_date_time</th>
      <th>elevation.value</th>
      <th>elevation.unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>GPS</td>
      <td>60.1867</td>
      <td>deg</td>
      <td>24.8283</td>
      <td>deg</td>
      <td>2016-02-05T20:35:00-08:00</td>
      <td>2016-02-06T06:35:00-08:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GPS</td>
      <td>60.1867</td>
      <td>deg</td>
      <td>24.8283</td>
      <td>deg</td>
      <td>2016-02-05T20:35:00-08:00</td>
      <td>2016-02-06T06:35:00-08:00</td>
      <td>20.4</td>
      <td>m</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Other-formats">
<h2>Other formats<a class="headerlink" href="#Other-formats" title="Link to this heading"></a></h2>
<p>You can add readers for any types of formats which you can convert into a Pandas dataframe (so basically anything). For examples of readers, see <code class="docutils literal notranslate"><span class="pre">niimpy/reading/read.py</span></code>. Apply the function <code class="docutils literal notranslate"><span class="pre">niimpy.preprocessing.util.df_normalize</span></code> in order to apply some standardizations to get the standard Niimpy format.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../quick-start/" class="btn btn-neutral float-left" title="Quick start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../basic-transformations/" class="btn btn-neutral float-right" title="Basic transformations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, the contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>